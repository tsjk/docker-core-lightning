version: '3'

services:
  core-lightning:
    build: "."
    image: core-lightning
    container_name: core-lightning
    network_mode: bridge
    extra_hosts:
      - "host.docker.internal:host-gateway"
    ports:
      - 127.0.0.1:9835:9835
      - 127.0.0.1:49836:49836
      - 127.0.0.1:49837:49837
      - 127.0.0.1:3000:3000
      - 0.0.0.0:9735:9735
    volumes:
      - ./config-lightning:/home/lightning/.config/lightning
      - ./lightning:/home/lightning/.lightning
# Set if you have your own config and don't want it to be autogenerated:
#      - config-c-lightning-REST-:/home/lightning/.config/c-lightning-REST
# Set if you have your own config and don't want it to be autogenerated:
#      - config-RTL:/home/lightning/.config/RTL
    environment:
      CLBOSS: "true"
      NETWORK_RPCD: "host.docker.internal:8332"
# Set NETWORK_RPCD_AUTH_SET to "true" after NETWORK_RPCD_USER and
# NETWORK_RPCD_PASSWORD have been updated to their correct settings.
# Alternatively, this can be set to "disabled" to instruct the container
# init script to ignore updating the configuration file with RPCD
# credentials (for the cases that it is already correct there).
      NETWORK_RPCD_AUTH_SET: "false"
# Note that here, "@", "\" and "&" signs cannot be used in neither
# NETWORK_RPCD_USER nor NETWORK_RPCD_PASSWORD.
      NETWORK_RPCD_PASSWORD: ""
      NETWORK_RPCD_USER: ""
# Set if you want use Tor and want to have socat proxies to the Tor daemon's
# socks and control ports:
#      TOR_SOCKSD: "host.docker.internal:9050"
#      TOR_CTRLD: "host.docker.internal:9051"
# Set if you need to authenticate for some Tor operations and want the
# container's init script to update the Core Lightning configuration file
# with the password given here (the "@", "\" and "&" signs cannot be used).
#    TOR_SERVICE_PASSWORD: "<PASSWORD>"
    stop_grace_period: 2m
    restart: "no"
